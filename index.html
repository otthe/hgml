<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HGML example</title>
  <script defer src="hgml.js" type="module"></script>
</head>
<body>

  <!-- MAKE SURE YOU ARE NOT USING ELEMENT NAMES THAT ARE RESERVED IN TRADITIONAL HTML -->
  <game w="800" h="600">

    <player x="100" y="100" w="32" h="32" color="blue">
      <method name="moveLeft" action="
        this.x -= 0.4 * hgml.G.deltaTime;">
      </method>
      <method name="moveUp" action="
        this.y -= 0.4 * hgml.G.deltaTime;">
      </method>
      <method name="moveRight" action="
        this.x += 0.4 * hgml.G.deltaTime;">
      </method>
      <method name="moveDown" action="
        this.y += 0.4 * hgml.G.deltaTime;">
      </method>
    </player>

    <wall x="200" y="200" w="32" h="32" color="black"></wall>
    <wall x="300" y="200" w="32" h="32" color="black"></wall>
    <wall x="400" y="200" w="32" h="32" color="black"></wall>

    <enemy x="300" y="300" w="64" h="64" color="red"></enemy>

    <item x="400" y="400" w="32" h="32" color="yellow"></item>

  </game>

</body>

<script type="module">
import HGML from './hgml.js';

const hgml = new HGML().init();
console.log(hgml.getState());


const keys = {};
document.addEventListener('keydown', (e) => {
  keys[e.key] = true; 
});
document.addEventListener('keyup', (e) => {
  keys[e.key] = false;
});

function update(obj, deltaTime) {
  if (obj.type === "PLAYER") {
    if (keys['ArrowLeft']) {
      obj.moveLeft(deltaTime);
    }
    if (keys['ArrowRight']) {
      obj.moveRight(deltaTime);
    }
    if (keys['ArrowUp']) {
      obj.moveUp(deltaTime);
    }
    if (keys['ArrowDown']) {
      obj.moveDown(deltaTime);
    }
  }
}

function render(obj, ctx) {
  ctx.fillStyle = obj.color || '#000';
  ctx.fillRect(obj.x, obj.y, obj.w, obj.h);
}

hgml.startGameLoop(update, render);
</script>

</html>